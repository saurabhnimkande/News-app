<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Montserrat:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap" rel="stylesheet">
  </head>
  <style>
      * {
        font-family: 'Montserrat', sans-serif;
    }
      #display_news > div {
          height: 450px;
          width: 700px;
          border: 1px solid #dedede;
          padding:10px;
          margin-bottom: 20px;

      }
      #display_news > div:hover {
          background-color:#f0f0f0;
          cursor: pointer;
      }
      #display_news > div > img {
          width: 300px;
          height: 150px;
      }
      #left_div {
          background-color:red;
          width: 300px;
          height: 700px;
      }
      #search_value {
          width: 250px;
          height:30px;
          margin-left: 20px;
          padding-left: 5px;
          margin-top: 10px;
      }
      #left_div > button {
          height: 25px;
          width:200px;
          margin-left:50px;

      }
  </style>
  <body>
    <div>
      <div id="left_div">
          <input type="text" id="search_value" placeholder="Search News">
          <button onclick="search_news()">Search</button>
      </div>
      <div id="display_news"></div>
    </div>
  </body>
  <script>
    async function get_top_news() {
      let res = await fetch(`https://newsapi.org/v2/everything?q=trending&from=2021-10-18&sortBy=popularity&apiKey=#00894624a7074153bc033e5d48e2c703`);
      let data= await res.json();
      console.log(data.articles);
      display_news(data.articles);
    }

    get_top_news();

    function display_news(object) {

        object.forEach((el) => {

            let parent_div=document.getElementById("display_news");

            let div=document.createElement("div");

                div.onclick=() => {
                    if(localStorage.getItem("news_details")==null) {
                        localStorage.setItem("news_details",JSON.stringify({}));
                    }

                    let newdata=JSON.parse(localStorage.getItem("news_details"));

                    newdata.image=el.urlToImage;
                    newdata.title=el.title
                    newdata.description=el.description;
                    newdata.date=el.publishedAt;
                    newdata.author=el.author;
                    newdata.source=el.source.name;
                    newdata.url=el.url;
                    newdata.content=el.content;

                    let one=JSON.stringify(newdata);
                    localStorage.setItem("news_details", one);

                    window.location.href="News.html";

                }

            let img=document.createElement("img");
            img.src=el.urlToImage;

            let title=document.createElement("h4");
            title.innerText=el.title;

            let author=document.createElement("p");
            if(el.author==null) {
                author.innerText="Not Available";
            } else {
                author.innerText=el.author;
            }

            let description=document.createElement("p");
            description.innerText=el.description;


            div.append(img,title,author,description);

            parent_div.append(div);


        })

    }



    let search_news=() => {

        let news_topic=document.getElementById("search_value").value;

        alert(news_topic);
        if(localStorage.getItem("topic")==null) {
            localStorage.setItem("topic",JSON.stringify({}));
          }


          let newdata=JSON.parse(localStorage.getItem("topic"));
          newdata.topic=news_topic;

          let one=JSON.stringify(newdata);
          localStorage.setItem("topic", one);

          window.location.href="Search.html";




    }



  </script>
</html>
